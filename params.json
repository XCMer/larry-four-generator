{"name":"Larry Four","tagline":"Laravel Four Generator","body":"If you are not already familiar, I had released a generator for Laravel called <a href=\"https://github.com/XCMer/larry-laravel-generator\">Larry</a>. This version is intended to work with Laravel 4, while supporting new features like polymorphic relations.\r\n\r\nLarry Four has been re-written from scratch for Laravel 4. We have a better syntax that allows more flexibility and room for adding in more features.\r\n\r\n**Current Version:** 1.0.1 (stable)\r\n\r\n## A bird's eye view\r\n\r\nHere's how an input to larry would look:\r\n\r\n    User users; hm Post; mo Image imageable; btm Role;\r\n        id increments\r\n        timestamps\r\n        username string 50; default \"hello world\"; nullable;\r\n        password string 64\r\n        email string 250\r\n        type enum admin, moderator, user\r\n\r\n    Post; mm Image imageable;\r\n        timestamps\r\n        title string 250\r\n        content text\r\n        rating decimal 5 2\r\n\r\n    Image\r\n        filename string\r\n\r\n    Role\r\n        name string\r\n        level integer\r\n\r\nIn the above case, Larry would do the following:\r\n\r\n- Create migration files for all the tables required, along with all the columns. Larry automatically figures out which foreign key columns to add, depending on the relations you define. Pivot table in case of belongsToMany relation is also automatically created.\r\n- Create model files for all the models defined. These models also have relational functions automatically defined in them.\r\n\r\n\r\n## Installation\r\n\r\nYou can visit <a href=\"https://packagist.org/packages/raahul/larryfour\">Packagist</a> to check the latest version of Larry Four. Currently, it is `1.0.1`.\r\n\r\nHere are the steps:\r\n\r\n- Put the following in your composer.json: `\"raahul/larryfour\": \"1.*\"`\r\n- Run `composer update`\r\n- Add `'Raahul\\LarryFour\\LarryFourServiceProvider'` to the `providers` array of `app/config/app.php`\r\n\r\n## Usage\r\n\r\nOnce you've successfully installed Larry Four, its commands should be accessible via `artisan`. You can always type just `php artisan` to see all available commands, and those available under the `larry` namespace.\r\n\r\nLarry Four supports **four commands.**\r\n\r\n    php artisan larry:generate <input_file>\r\n\r\nThe above command takes `<input_file>` as the input, and generates models and migrations based on that. You have to provide a filename that exists at the root of your Laravel 4 installation, wherein artisan itself resides.\r\n\r\nYou cannot provide absolute paths for the input file yet. If you're providing a relative path instead of a filename, then it is relative to Laravel's root directory (or basepath).\r\n\r\nThere are two other commands:\r\n\r\n    // Generate only migrations, not models\r\n    php artisan larry:migrations <input_file>\r\n\r\n    // Generate only models, not migrations\r\n    php artisan larry:models <input_file>\r\n\r\n\r\n### Generating migrations from existing tables\r\n\r\nThe fourth command is a bit different, since it allows you to generate migrations from existing tables. Use it as follows:\r\n\r\n    php artisan larry:fromdb\r\n\r\nBy default, it will pick up all the tables in the database (except the Laravel migration table). Larry Four will always show you a list of tables that will be processed and ask you for a confirmation.\r\n\r\nThe tables that Larry processes can be altered by specifying the `only` and `except` options to the command.\r\n\r\n    // This will process only the tables 'users' and 'posts'\r\n    php artisan larry:fromdb --only=users,posts\r\n\r\n    // This will process all tables except users and posts\r\n    php artisan larry:fromdb --except=users,posts\r\n\r\n\r\nAgain, you'll get to confirm your selection before the migrations are generated.\r\n\r\nLarry Four is intelligent, in that it can distinguish booleans from other tinyints, and increments from a normal unsigned integer.\r\n\r\nBe aware that your tables need to have a integer primary key. If it is not found, the migration would automatically contain an `id` field.\r\n\r\n\r\n## Syntax reference\r\n\r\nCreate a new text file at the root of your Laravel installation, and you can name it anything you want. The input file basically defines the following things:\r\n\r\n- All the models that should be created\r\n- The relationship between those models\r\n- The fields inside each of those models\r\n- Modifiers to the fields like default values, nullable/unsigned, and indices\r\n\r\nAll the models get an auto-incrementing primary key called `id`. You can override the name of the primary key. All foreign keys created are unsigned.\r\n\r\nLarry provides ways to override foreign key and pivot table names as well. These are optional. By default, Larry follows the same convention as Laravel for naming tables, pivot tables, and foreign keys.\r\n\r\nFinally, Larry ignores blank lines (even if they contain whitespace). So, you're free to beautify the looks of your input.\r\n\r\nNow, let's begin with the syntax.\r\n\r\n### Model definition\r\n\r\nModel definition is how you tell Larry about a new model that has to be created. Since fields need a model to be added to, a model definition will be the first logical line of your input file.\r\n\r\nWhen defining a new model, the line **should not** be indented by any amount of whitespace.\r\n\r\nThe most simple model definition would look like this:\r\n\r\n    User\r\n\r\nAll models will automatically get an `id` field of type `increments`. Apart from just defining the model, you can also define relations between models on this line.\r\n\r\n    User users; hm Post; mo Image imageable; btm Role;\r\n\r\nIn the above case, we specify the relation that the user has with the other models. The types of the relations supported are:\r\n\r\n    hm: hasMany\r\n    ho: hasOne\r\n    btm: belongToMany\r\n    btmc: belongsToMany with custom pivot table\r\n    mm: morphMany\r\n    mo: morphOne\r\n\r\nNotice that you can't specify `belongsTo` and `morphTo` relations. They are added automatically to the concerned model when their inverses, `hasMany, hasOne, morphMany, morphOne`, are specified in a related model.\r\n\r\nThe `belongsToMany` with custom pivot table is covered in the section: \"Creating orphan tables\"\r\n\r\n#### Semicolons\r\n\r\nWhen defining related models, each definition is delimited by a semicolon. The final semicolon is optional.\r\n\r\n\r\n#### Overriding table name\r\n\r\nYou can override the table name of the current model by simply adding it after the model name.\r\n\r\n    User my_users; hm Post\r\n\r\nThe generated model and migration will take this into account.\r\n\r\n\r\n#### Overriding foreign key and pivot table names\r\n\r\nWhile specifying relations above, you can override the foreign key used. This can be done as:\r\n\r\n    User; hm Post my_user_id;\r\n\r\nIn the above case, the foreign key `my_user_id` will be used instead of the conventional `user_id`. Larry takes care of the naming in the migrations, as well as overriding the default foreign key in the model's relation function.\r\n\r\nIn case of `belongsToMany`, you can override the pivot table name:\r\n\r\n    // pivot table will be named \"r_u\" instead of the\r\n    // conventional role_user\r\n    User; btm Role r_u;\r\n\r\nAnd also the foreign keys inside the pivot table:\r\n\r\n    // foreign keys are named \"u_id\" & \"r_id\" instead of\r\n    // the conventional \"user_id\" & \"role_id\"\r\n    User; btm Role r_u u_id r_id;\r\n\r\nFor polymorphic relations (`morphOne` and `morphMany`), it is mandatory to specify a second paramater to the relation, indicating the name of the polymorphic function:\r\n\r\n    User; mm Image imageable;\r\n\r\n\r\n### Field definition\r\n\r\nAfter you define a model, you need to define fields for it.\r\n\r\n    User users; hm Post; mo Image imageable;\r\n        id increments\r\n        timestamps\r\n        username string 50; default \"hello world\"; nullable;\r\n        password string 64\r\n        email string 250\r\n        type enum admin, moderator, user\r\n        softDeletes\r\n\r\nLooking above, you'll get a good idea of how fields are defined. The syntax is as follows:\r\n\r\n    <field_name> <field_type> <field_parameters>; <field_modifier>; <field_modifier> ...\r\n\r\n- The `<field_name>` is simply the column name.\r\n- The `<field_type>` is any of the field types supported by Laravel.\r\n- `<field_parameters>` are additional parameters to a field function, like length of a string.\r\n- `<field_modifier>` includes default, nullable, unsigned , and indices. Multiple field modifiers can be specified for a field.\r\n\r\n**Below are certain points to note:**\r\n\r\nThe `increments` field is optional, and you should have a need to specify it only if you want your auto-incrementing field to be named differently from `id`.\r\n\r\nThe `timestamps` and `softDeletes` fields are special, for they have no field name. By default, timestamps and softDeletes are disabled in all the models, and migrations don't create columns for them. By adding either of them as a field, you enable them for that model, and the migration will contain the necessary columns.\r\n\r\nAnother field that has a different syntactical nuance is the `enum` field. The parameters to the enum fields are separated by commas. They may or may not be individually enclosed in quotes, like:\r\n\r\n    type enum \"admin\", \"moderator\", \"user\"\r\n    OR\r\n    type enum admin, moderator, user\r\n\r\nOther types work as expected, and have syntax similar to the `string` type you see above.\r\n\r\nThe following field types are supported:\r\n\r\n    increments\r\n    string\r\n    integer\r\n    bigInteger\r\n    smallInteger\r\n    float\r\n    decimal\r\n    boolean\r\n    date\r\n    dateTime\r\n    time\r\n    timestamp (not to be confused with timestamp**s**)\r\n    text\r\n    binary\r\n    enum\r\n    softDeletes\r\n\r\nAnd the following field modifiers are supported:\r\n\r\n    default \"value\"\r\n    nullable\r\n    unsigned\r\n    primary\r\n    fulltext\r\n    unique\r\n    index\r\n\r\n\r\n### Creating orphan tables\r\n\r\nNow, Larry also allows you to create tables (or migrations to precise), without creating models and relations for that table. In short, it's a quick way to add in just a table.\r\n\r\nThis feature is primarily useful in creating custom pivot tables for the `btmc` relation type. Pivot tables are not associated with any models.\r\n\r\nNormally, for `btm` relations, a pivot table is automatically created for you with the required fields. However, at times, you'd want to have additional fields in your pivot table. In such cases, you should use the `btmc` relation, and then specify a custom table with all the desired columns.\r\n\r\nAn example would be:\r\n\r\n    Post; mm Image imageable; btmc Comment;\r\n        timestamps\r\n        title string 250\r\n        content text\r\n        rating decimal 5 2\r\n\r\n    table comment_post\r\n        comment_id integer; unsigned\r\n        post_id integer; unsigned\r\n        name string\r\n        type string\r\n        additional fields...\r\n\r\nA Post now belongsToMany comments (unusual). Laravel's convention dictates that the pivot table should be called `comment_post`, and the fields inside should be `comment_id` and `post_id`.\r\n\r\nYou can override the pivot table name and field names the same way as you did in `btm`. Just make sure that your custom table reflects it.\r\n\r\nCustom tables are defined using the term `table <table_name>`, as you might have noticed. This is how Larry differentiates whether you want to define a model, or an orphan table.\r\n\r\nIf you specify additional fields, they will be automatically added to `withPivot` function in the model's relation:\r\n\r\n    return $this->belongsToMany('Comment')->withPivot('name', 'type');\r\n\r\nIf your pivot table contains timestamps, Larry will add them to the relational function too:\r\n\r\n    return $this->belongsToMany('Comment')->withPivot('name', 'type')->withTimestamps();\r\n\r\n**Note:** If you don't create a pivot table with the right name, or the pivot table doesn't contain the necessary columns for a `belongsToMany` relation, Larry will throw a helpful error. Remember that the foreign keys of a pivot table have to be unsigned integers.\r\n\r\n\r\n## Error handling\r\n\r\nLarry Four has an improved error handling mechanism. If there are syntax errors in your input file, you will be notified about it along with the line number. The error will tell you exactly what's wrong in plain English.\r\n\r\nCurrently, Larry can detect the following errors:\r\n\r\n- Typo in relationship types (typing `hms` instead of `hm` will yield an error)\r\n- Insufficient parameters to relationships or field definitions\r\n- Non-existance of a model that was specified as related in another model\r\n- Invalid field types\r\n\r\n## Testing\r\n\r\nThe repo contains PHPUnit tests. This should keep the bugs out and also expedite feature releases.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}